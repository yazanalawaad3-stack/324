<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Demo Trading (Educational) - Pro UI</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Back button (unified style) */
    .luxBack{
      width:36px;height:36px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(11,12,16,.95);
      display:flex;align-items:center;justify-content:center;
      text-decoration:none;flex:0 0 auto
    }
    .luxArrow{
      width:10px;height:10px;
      border-left:2px solid #f5c542;
      border-bottom:2px solid #f5c542;
      transform:rotate(45deg);
      margin-left:2px
    }

    /* Responsive fixes (do not touch JS / Supabase wiring) */
    #chartCanvas{width:100%;height:420px;display:block}

    @media (max-width: 980px){
      header.top{flex-wrap:wrap;gap:10px}
      header.top .topRight{width:100%;flex-wrap:wrap;justify-content:flex-start;gap:10px}
      main.layout{display:flex;flex-direction:column;gap:14px}
      .chartCard,.side{width:100%}
      .tableWrap{overflow:auto}
      #chartCanvas{height:360px}
    }
    @media (max-width: 480px){
      header.top .sub{display:none}
      #chartCanvas{height:320px}
    }
  </style>
</head>
<body>
  <header class="top">
    <a class="luxBack" href="myassets.html" aria-label="Back"><span class="luxArrow"></span></a>
    <div class="brand">
      <div class="dot"></div>
      <div>
        <div class="title">Demo Trading Terminal</div>
        <div class="sub">Educational demo only. No real trading. Local-only demo points.</div>
      </div>
    </div>

    <div class="topRight">
      <div class="badge">Symbol: <span class="mono" id="symbol">BTCUSDT</span></div>
      <div class="badge">Price: <span class="mono" id="lastPrice">—</span></div>
      <button class="btn ghost" id="refreshBtn" type="button">Refresh</button>
    </div>
  </header>

  <main class="layout">
    <section class="chartCard">
      <div class="cardHead">
        <div>
          <div class="h">Chart</div>
          <div class="p">Live candles drawn locally on canvas using Binance kline data. No external chart widget.</div>
        </div>
        <div class="right">
          <div class="pill">1m</div>
          <div class="pill">BINANCE</div>
        </div>
      </div>

      <div class="chartWrap">
        <div class="chartWrap">
        <div class="chartInner">
          
        <div class="tradeBar" id="tradeBar">
          <button class="btn buy" id="buyBtnFs" type="button">Buy</button>
          <button class="btn sell" id="sellBtnFs" type="button">Sell</button>
          <button class="btn ghost" id="closeBtnFs" type="button">Close</button>
        </div>

          <canvas id="chartCanvas"></canvas>
          
          <div class="chartToolbar">
            <div class="tfGroup">
              <button class="tbtn" data-tf="1m">1m</button>
              <button class="tbtn" data-tf="5m">5m</button>
              <button class="tbtn" data-tf="15m">15m</button>
              <button class="tbtn" data-tf="1h">1h</button>
              <button class="tbtn" data-tf="4h">4h</button>
              <button class="tbtn" data-tf="1d">1d</button>
            </div>
            <div class="toolGroup">
              <label class="chk"><input type="checkbox" id="sma20" checked> SMA20</label>
              <label class="chk"><input type="checkbox" id="sma50"> SMA50</label>
              <label class="chk"><input type="checkbox" id="ema20"> EMA20</label>
              <button class="tbtn ghost" id="resetViewBtn" type="button">Reset view</button>
              <button class="tbtn ghost" id="fsBtn" type="button">Fullscreen</button>
            </div>
          </div>

          <div class="chartOverlay">
            <div class="ovItem">Internal canvas chart</div>
            <div class="ovItem mono">1m</div>
          </div>
        </div>
      </div>

      <div class="hintRow">
        <span class="hint">This is a simulated trading UI. Actions below update demo balance + pool only.</span>
      </div>
    </section>

    <aside class="side">
      <section class="panel">
        <div class="panelHead">
          <div>
            <div class="h">Order Panel</div>
            <div class="p">Buy/Sell buttons + timer close (simulated).</div>
          </div>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="k">Balance</div>
            <div class="v mono" id="balance">—</div>
          </div>
          <div class="stat">
            <div class="k">Pool</div>
            <div class="v mono" id="pool">—</div>
          </div>
          <div class="stat">
            <div class="k">Next Result</div>
            <div class="v mono" id="nextOutcome">—</div>
          </div>
        </div>

        <div class="field">
          <label for="stake">Stake (demo points)</label>
          <input id="stake" type="text" inputmode="numeric" value="100" />
          <div class="mini">Arabic-Indic digits are supported (e.g. ١٠٠).</div>
        </div>

        <div class="row2">
          <div class="field">
            <label for="leverage">Leverage (UI only)</label>
            <input id="leverage" type="number" min="1" max="100" value="10" />
          </div>
          <div class="field">
            <label for="duration">Duration</label>
            <select id="duration">
              <option value="15">15s</option>
              <option value="30" selected>30s</option>
              <option value="60">60s</option>
              <option value="120">120s</option>
            </select>
          </div>
        </div>

        <div class="actions">
          <button class="btn buy" id="buyBtn" type="button">Buy / Long</button>
          <button class="btn sell" id="sellBtn" type="button">Sell / Short</button>
        </div>

        <div class="divider"></div>

        <div class="pos">
          <div class="posHead">
            <div class="h">Open Position</div>
            <div class="p">One position at a time (demo).</div>
          </div>

          <div id="noPos" class="empty">No open position.</div>

          <div id="posBox" class="posBox hidden">
            <div class="posGrid">
              <div>
                <div class="k">Side</div>
                <div class="v mono" id="posSide">—</div>
              </div>
              <div>
                <div class="k">Entry Price</div>
                <div class="v mono" id="posEntry">—</div>
              </div>
              <div>
                <div class="k">Stake</div>
                <div class="v mono" id="posStake">—</div>
              </div>
              <div>
                <div class="k">Timer</div>
                <div class="v mono" id="posTimer">—</div>
              </div>
            </div>

            <div class="posActions">
              <button class="btn ghost" id="closeNowBtn" type="button">Close Now</button>
              <button class="btn ghost" id="resetBtn" type="button">Reset Demo</button>
            </div>

            <div class="rules">
              <div class="h">Demo Rules</div>
              <ul>
                <li>Fixed sequence: LOSS, LOSS, WIN (repeat)</li>
                <li>LOSS: balance -= stake; pool += 70% of stake; fee = 30% of stake</li>
                <li>WIN: payout = 30% of pool; pool resets to 0</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panelHead">
          <div>
            <div class="h">History</div>
            <div class="p">Local-only (stored in your browser).</div>
          </div>
        </div>
        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Time</th>
                <th>Side</th>
                <th>Stake</th>
                <th>Outcome</th>
                <th>Payout</th>
                <th>Fee</th>
                <th>Balance</th>
              </tr>
            </thead>
            <tbody id="histBody">
              <tr><td colspan="8" class="muted">No trades yet.</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </aside>
  </main>

  <footer class="foot">
    <span class="footPill">Local demo points</span>
    <span class="footPill">No database</span>
    <span class="footPill">No real trading</span>
  </footer>

  <!-- Supabase wiring (same pattern used across the site) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="./supabase-config.js"></script>
  <script src="./supabase-client.js"></script>
  <script src="./session.js"></script>
  <script src="./game.api.js"></script>
  <script src="game.js"></script>
</body>
</html>
