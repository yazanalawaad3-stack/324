<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Lux Dashboard</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap (layout utilities) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />

  <!-- Crypto icon font (BNB / TRX / ETH) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/cryptocoins/2.9.0/webfont/cryptocoins.css" rel="stylesheet" />

  <link rel="stylesheet" href="./styles.css" />

  <style>
    /* Settings menu upgrade (style only) */
    .lux-menu{
      width: 280px;
      max-width: calc(100vw - 24px);
      max-height: calc(100vh - 120px);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      border-radius: 18px;
      background: rgba(10,14,30,.55);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow: hidden;
    }

    .lux-menu-item{
      width: 100%;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: transparent;
      border: 0;
      color: rgba(255,255,255,.88);
      transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
      border-radius: 12px;
      margin: 5px 6px;
    }

    .lux-menu-item:hover{
      background: rgba(255,255,255,.06);
      transform: translateY(-1px);
    }

    .lux-menu-item:active{
      transform: translateY(0px) scale(.99);
    }

    .lux-menu-ic{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 0 1px rgba(255,255,255,.04);
      flex: 0 0 34px;
    }

    .lux-menu-ic i{
      font-size: 16px;
      opacity: .95;
    }

    .lux-menu-tx{
      font-size: 14px;
      font-weight: 600;
      letter-spacing: .2px;
    }

    .lux-menu-divider{
      height: 1px;
      margin: 10px 14px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.14), transparent);
    }

    /* Per-item accent colors */
    .lux-menu-item[data-action="member"] .lux-menu-ic i{ color:#FFD36E; }
    .lux-menu-item[data-action="rewards"] .lux-menu-ic i{ color:#7CF0C7; }
    .lux-menu-item[data-action="luckydraw"] .lux-menu-ic i{ color:#FF8BD6; }
    .lux-menu-item[data-action="security"] .lux-menu-ic i{ color:#8FB5FF; }
    .lux-menu-item[data-action="language"] .lux-menu-ic i{ color:#D08BFF; }

    .lux-menu-item[data-action="about"] .lux-menu-ic i{ color:#FFD36E; }
    .lux-menu-item[data-action="guide"] .lux-menu-ic i{ color:#7CF0C7; }
    .lux-menu-item[data-action="getapp"] .lux-menu-ic i{ color:#8FB5FF; }
  

/* Lux bottom quick actions - premium icon tabs */
.lux-quick-wrap{
  margin-top: 14px;
  padding: 14px;
  border-radius: 18px;
  background: rgba(10,14,30,.35);
  border: 1px solid rgba(255,255,255,.08);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  box-shadow: 0 18px 60px rgba(0,0,0,.35);
}
.lux-quick-row{
  display:flex;
  gap:14px;
}
.lux-quick{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding: 14px 10px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(255,255,255,.05);
  color: rgba(255,255,255,.86);
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.lux-quick:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.12);
}
.lux-quick:active{
  transform: translateY(0px) scale(.99);
}
.lux-quick-label{
  font-size: 13px;
  font-weight: 700;
  letter-spacing: .2px;
}
.lux-quick-ico{
  width: 36px;
  height: 36px;
  border-radius: 14px;
  display:grid;
  place-items:center;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.06);
}
.lux-quick-ico i{
  font-size: 16px;
}

/* Icon colors + glow */
#walletBtn .lux-quick-ico i{ color:#FFD36E; }
.lux-quick-row .lux-quick:nth-child(2) .lux-quick-ico i{ color:#7CF0C7; }
#quickNetworkBtn .lux-quick-ico i{ color:#8FB5FF; }
#analyticsBtn .lux-quick-ico i{ color:#D08BFF; }

#walletBtn .lux-quick-ico{ box-shadow: 0 0 0 1px rgba(255,211,110,.18), 0 10px 30px rgba(255,211,110,.10); }
.lux-quick-row .lux-quick:nth-child(2) .lux-quick-ico{ box-shadow: 0 0 0 1px rgba(124,240,199,.18), 0 10px 30px rgba(124,240,199,.10); }
#quickNetworkBtn .lux-quick-ico{ box-shadow: 0 0 0 1px rgba(143,181,255,.18), 0 10px 30px rgba(143,181,255,.10); }
#analyticsBtn .lux-quick-ico{ box-shadow: 0 0 0 1px rgba(208,139,255,.18), 0 10px 30px rgba(208,139,255,.10); }
</style>

</head>
<body class="lux-body">
  <div class="lux-ai-bg" aria-hidden="true"></div>
  <div class="lux-app">

    <!-- Top overlay (outside cards) -->
    <div class="lux-top-id" aria-label="User ID">
      <div class="lux-id-chip" role="group" aria-label="User ID">
        <span class="lux-id-label">ID</span>
        <span class="lux-id-value" id="userIdValue"></span>
        <button class="lux-id-copy" id="copyUserIdBtn" type="button" aria-label="Copy user ID">
          <i class="fa-regular fa-copy" aria-hidden="true"></i>
        </button>
      </div>
    </div>

    <div class="lux-top-actions" aria-label="Top actions">
      <button class="lux-gear-fab lux-top-action" id="refreshBtn" type="button" aria-label="Refresh">
        <i class="fa-solid fa-arrows-rotate" aria-hidden="true"></i>
      </button>
      <button class="lux-gear-fab lux-top-action" id="settingsBtn" type="button" aria-label="Settings">
        <i class="fa-solid fa-gear" aria-hidden="true"></i>
      </button>
    </div>

    <!-- Settings dropdown (opened from gear) -->
    <div class="lux-menu" id="settingsMenu" role="menu" aria-label="Settings menu" aria-hidden="true">
      <button class="lux-menu-item" type="button" data-action="member" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-user-check"></i></span>
        <span class="lux-menu-tx">Member</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="rewards" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-trophy"></i></span>
        <span class="lux-menu-tx">Rewards</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="luckydraw" role="menuitem" onclick="window.location.href='./Luckydraw.html'">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-gift"></i></span>
        <span class="lux-menu-tx">Lucky Draw</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="security" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-shield-halved"></i></span>
        <span class="lux-menu-tx">Security Center</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="language" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-language"></i></span>
        <span class="lux-menu-tx">Language Settings</span>
      </button>
      <div class="lux-menu-divider" aria-hidden="true"></div>
      <button class="lux-menu-item" type="button" data-action="about" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-circle-info"></i></span>
        <span class="lux-menu-tx">About Platform</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="guide" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-book-open"></i></span>
        <span class="lux-menu-tx">Platform Guide</span>
      </button>
      <button class="lux-menu-item" type="button" data-action="getapp" role="menuitem">
        <span class="lux-menu-ic" aria-hidden="true"><i class="fa-solid fa-mobile-screen-button"></i></span>
        <span class="lux-menu-tx">Get the App</span>
      </button>
    </div>

    <!-- Top header -->
    <header class="lux-header">
      <div class="container px-3">
        <div class="lux-balance-card">

          <div class="lux-usdt-mark" aria-hidden="true">
            <img class="lux-usdt-coin-img" src="usdt_coin.webp" alt="" loading="lazy" />
          </div>

          <div class="d-flex align-items-start justify-content-between gap-3">
            <div>
	              <div class="lux-balance">
	                <span id="demoBalance">00,00</span>
	                <span class="lux-balance-unit">USDT</span>
	              </div>
</div>
          </div>

          <div class="lux-divider"></div>

          <!-- mini stats inside the same box -->
          <div class="lux-mini-grid">
            <div class="lux-mini">
              <div class="lux-mini-label">Today's Activity</div>
              <div class="lux-mini-value" id="todayIncome">00.00</div>
            </div>
            <div class="lux-mini">
              <div class="lux-mini-label">Total Activity</div>
              <div class="lux-mini-value" id="totalIncome">00,00</div>
            </div>
            <div class="lux-mini">
              <div class="lux-mini-label">Network Activity</div>
              <div class="lux-mini-value" id="teamIncome">00.00</div>
            </div>
            <div class="lux-mini">
              <div class="lux-mini-label">Total Network Activity</div>
              <div class="lux-mini-value" id="teamTotalIncome">00,00</div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main content -->
    <main class="lux-main">
      <div class="container px-3">

        <!-- Referral / Invite friends card -->
        <section class="lux-referral" aria-label="Invite friends">
          <div class="lux-referral-card">
            <div class="lux-referral-left">
              <div class="lux-referral-title">
                <span class="lux-referral-ico" aria-hidden="true"><i class="fa-solid fa-users"></i></span>
                <span>Invite Program</span>
              </div>
              <div class="lux-referral-sub">Welcome! Invite your friends now</div>
            </div>

            <button class="lux-referral-btn" id="inviteFriendsBtn" type="button">
              Invite Friends
            </button>
          </div>
        </section>

        <div class="lux-empty">

          <div class="lux-quick-wrap" aria-label="Quick actions">
            <div class="lux-quick-row">
            <button class="lux-quick" id="walletBtn" type="button">
              <span class="lux-quick-ico"><i class="fa-solid fa-wallet"></i></span>
              <span class="lux-quick-label">Wallet</span>
            </button>

            <button class="lux-quick" type="button">
              <span class="lux-quick-ico"><i class="fa-solid fa-paper-plane"></i></span>
              <span class="lux-quick-label">Transfer</span>
            </button>

            <button class="lux-quick" id="quickNetworkBtn" type="button" aria-label="Network">
              <span class="lux-quick-ico"><i class="fa-solid fa-users"></i></span>
              <span class="lux-quick-label">Network</span>
            </button>

            <button class="lux-quick" id="analyticsBtn" type="button">
              <span class="lux-quick-ico"><i class="fa-solid fa-file-lines"></i></span>
              <span class="lux-quick-label">Analytics</span>
            </button>
            </div>

            <!-- Live network rates (BEP20 / TRC20 / ERC20) -->
            <div class="lux-netrates" aria-label="Network rates">
              <div class="lux-netrates-head">
                <div class="lux-netrates-title">Networks</div>
              </div>

              <div class="lux-netrates-list">
                <div class="lux-netrate" data-net="bep20">
                  <div class="lux-netrate-ic" aria-hidden="true">
                    <i class="cc BNB" aria-hidden="true"></i>
                  </div>
                  <div class="lux-netrate-mid">
                    <div class="lux-netrate-top">
                      <div class="lux-netrate-name">BEP20</div>
                      <div class="lux-netrate-chip" id="rateBNB" aria-label="BNB USD">--</div>
                    </div>
                    <div class="lux-netrate-sub">
                      <span class="lux-netrate-desc">BNB Smart Chain</span>
                      <span class="lux-netrate-sep">•</span>
                      <span class="lux-netrate-change" id="chgBNB">--</span>
                    </div>
                  </div>
                </div>

                <div class="lux-netrate" data-net="trc20">
                  <div class="lux-netrate-ic" aria-hidden="true">
                    <i class="cc TRX" aria-hidden="true"></i>
                  </div>
                  <div class="lux-netrate-mid">
                    <div class="lux-netrate-top">
                      <div class="lux-netrate-name">TRC20</div>
                      <div class="lux-netrate-chip" id="rateTRX" aria-label="TRX USD">--</div>
                    </div>
                    <div class="lux-netrate-sub">
                      <span class="lux-netrate-desc">Tron Network</span>
                      <span class="lux-netrate-sep">•</span>
                      <span class="lux-netrate-change" id="chgTRX">--</span>
                    </div>
                  </div>
                </div>

                <div class="lux-netrate" data-net="erc20">
                  <div class="lux-netrate-ic" aria-hidden="true">
                    <i class="cc ETH" aria-hidden="true"></i>
                  </div>
                  <div class="lux-netrate-mid">
                    <div class="lux-netrate-top">
                      <div class="lux-netrate-name">ERC20</div>
                      <div class="lux-netrate-chip" id="rateETH" aria-label="ETH USD">--</div>
                    </div>
                    <div class="lux-netrate-sub">
                      <span class="lux-netrate-desc">Ethereum Network</span>
                      <span class="lux-netrate-sep">•</span>
                      <span class="lux-netrate-change" id="chgETH">--</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="lux-netrates-foot" id="ratesUpdatedAt" aria-label="Last update">Updating…</div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Bottom navigation -->
    <nav class="lux-dock" aria-label="Bottom navigation">
      <div class="lux-dock-inner">
        <button class="dock-item active" data-screen="market" aria-label="Market">
          <span class="dock-ic"><i class="fa-solid fa-chart-line" aria-hidden="true"></i></span>
          <span class="dock-tx">Market</span>
        </button>
        <button class="dock-item" data-screen="packages" aria-label="packages">
          <span class="dock-ic"><i class="fa-solid fa-chart-column" aria-hidden="true"></i></span>
          <span class="dock-tx">packages</span>
        </button>
        <button class="dock-item dock-center" data-screen="Ai assets" aria-label="Ai Assets">
          <span class="dock-ic">
            <dotlottie-player class="dock-lottie assets-robot" src="data:application/octet-stream;base64,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" background="transparent" speed="1" loop autoplay></dotlottie-player>
          </span>
          <span class="dock-tx">Ai Assets</span>
        </button>
        <button class="dock-item" data-screen="community" aria-label="Community">
          <span class="dock-ic"><i class="fa-solid fa-comments" aria-hidden="true"></i></span>
          <span class="dock-tx">Community</span>
        </button>
        <button class="dock-item" data-screen="profile" aria-label="Profile">
          <span class="dock-ic"><i class="fa-solid fa-id-badge" aria-hidden="true"></i></span>
          <span class="dock-tx">Profile</span>
        </button>
        <div class="dock-indicator" aria-hidden="true"></div>
      </div>
    </nav>

    <!-- Toast -->
    <div class="lux-toast" id="luxToast" role="status" aria-live="polite" aria-atomic="true">
      <div class="lux-toast-inner">
        <i class="fa-solid fa-sparkles me-2"></i>
        <span id="toastText">Done</span>
      </div>
    </div>

  </div>

  <script type="module" src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs"></script>
  <script nomodule src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
(function(){
  // Minimal config loader
  function readConfig() {
    try {
      if (window.LUX_CONFIG && typeof window.LUX_CONFIG === 'object') return window.LUX_CONFIG;
      const raw = localStorage.getItem('lux_supabase_config') || localStorage.getItem('supabase_config');
      if (!raw) return null;
      const cfg = JSON.parse(raw);
      if (!cfg || typeof cfg !== 'object') return null;
      return cfg;
    } catch (e) {
      return null;
    }
  }

  // Create shared namespace
  window.LUX = window.LUX || {};
  window.LUX.session = window.LUX.session || {};

  // Basic session/uid resolver (non-blocking)
  window.LUX.session.getUserId = function() {
    const raw =
      window.LUX_USER_ID ||
      window.USER_ID ||
      localStorage.getItem('lux_user_id') ||
      localStorage.getItem('user_id') ||
      localStorage.getItem('uid') ||
      '';
    const uid = String(raw || '').trim();
    return uid || null;
  };

  window.LUX.session.requireAuth = function(redirectUrl) {
    // If you have a login flow, store user id in localStorage as lux_user_id
    const uid = window.LUX.session.getUserId();
    if (!uid) {
      // Do not redirect automatically to avoid breaking offline preview
      return null;
    }
    return uid;
  };

  function initSupabase() {
    const cfg = readConfig();
    if (!cfg) return null;
    const url = String(cfg.supabaseUrl || cfg.url || '').trim();
    const key = String(cfg.supabaseAnonKey || cfg.anonKey || cfg.key || '').trim();
    if (!url || !key) return null;
    if (!window.supabase || !window.supabase.createClient) return null;
    try {
      return window.supabase.createClient(url, key);
    } catch (e) {
      return null;
    }
  }

  // Init client if possible
  const client = initSupabase();
  if (client) {
    window.LUX.sb = client;
  }
})();
</script>

<script>
// API loader (safe, never blocks UI)
(function(){
  function qs(s, el=document){ return el.querySelector(s); }
  const balanceEl = qs('#balanceValue') || qs('[data-balance]') || null;
  const todayEl = qs('#todayValue') || null;
  const totalEl = qs('#totalValue') || null;
  const netTodayEl = qs('#netTodayValue') || null;
  const netTotalEl = qs('#netTotalValue') || null;

  function setText(el, v){ if(el) el.textContent = v; }
  function fmt(v) {
    const n = Number(v);
    if (!Number.isFinite(n)) return '--';
    return n.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  }

  async function loadFromDb() {
    const sb = window.LUX && window.LUX.sb;
    if (!sb) return false;

    const uid = (window.LUX.session && window.LUX.session.getUserId && window.LUX.session.getUserId()) || null;
    if (!uid) return false;

    try {
      const res = await sb
        .from('v_user_activity')
        .select('balance,todays_activity,total_activity,network_activity_today,total_network_activity')
        .eq('user_id', uid)
        .maybeSingle();

      const row = res && res.data ? res.data : null;
      if (!row) return false;

      // Update UI if elements exist
      if (balanceEl) setText(balanceEl, fmt(row.balance));
      if (todayEl) setText(todayEl, fmt(row.todays_activity));
      if (totalEl) setText(totalEl, fmt(row.total_activity));
      if (netTodayEl) setText(netTodayEl, fmt(row.network_activity_today));
      if (netTotalEl) setText(netTotalEl, fmt(row.total_network_activity));

      return true;
    } catch (e) {
      return false;
    }
  }

  async function loadFallback() {
    // Keep UI functional even without DB
    const cached = localStorage.getItem('lux_cached_balance');
    if (cached && balanceEl) {
      setText(balanceEl, fmt(cached));
    }
  }

  function hookRefresh() {
    const btn =
      qs('#refreshBtn') ||
      qs('[data-action="refresh"]') ||
      null;
    if (!btn) return;
    btn.addEventListener('click', async (e) => {
      try {
        e.preventDefault();
      } catch {}
      await loadFromDb();
    });
  }

  // Run after DOM is ready
  function start() {
    hookRefresh();
    loadFallback();
    // Attempt DB load without blocking
    loadFromDb();
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', start, { once: true });
  } else {
    start();
  }
})();
</script>

<script>
(() => {
  const qs = (s, el=document) => el.querySelector(s);
  const qsa = (s, el=document) => [...el.querySelectorAll(s)];

  const toastEl = qs('#luxToast');
  const toastText = qs('#toastText');
  let toastTimer = null;

  function toast(msg){
    toastText.textContent = msg;
    toastEl.classList.add('show');
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => toastEl.classList.remove('show'), 1400);
  }

  async function safeCopy(text){
    try{
      await navigator.clipboard.writeText(String(text));
      return true;
    }catch{
      try{
        const ta = document.createElement('textarea');
        ta.value = String(text);
        ta.setAttribute('readonly','');
        ta.style.position = 'fixed';
        ta.style.top = '-1000px';
        document.body.appendChild(ta);
        ta.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(ta);
        return !!ok;
      }catch{
        return false;
      }
    }
  }

  // Bottom dock active state + indicator
  const navItems = qsa('.dock-item');
  const indicator = qs('.dock-indicator');

  function activateDock(screen){
    const btn = navItems.find(b => b.getAttribute('data-screen') === screen);
    if(!btn) return;
    navItems.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    updateIndicator();
    const labelEl = btn.querySelector('.dock-tx');
    const label = (labelEl ? labelEl.textContent : (btn.getAttribute('aria-label') || screen));
    toast(String(label).trim() || 'Ready');
  }
  function updateIndicator(){
    const activeIndex = Math.max(0, navItems.findIndex(b => b.classList.contains('active')));
    const step = (indicator.parentElement.clientWidth - 20) / 5; // inner width minus padding
    indicator.style.transform = `translateX(${activeIndex * step}px)`;
  }

  navItems.forEach(btn => {
    btn.addEventListener('click', () => {
      const screen = btn.getAttribute('data-screen');
      activateDock(screen);
      // Navigate to dedicated pages when tapping bottom nav items
      if(screen && typeof screen === 'string'){
        const s = screen.toLowerCase();
        if(s === 'packages'){
          window.location.href = './packages.html';
        }else if(s.includes('ai')){
          window.location.href = './ai-assets.html';
        }else if(s === 'market'){
          window.location.href = './index000.html';
        }
      }
    });
  });

  window.addEventListener('resize', updateIndicator);
  updateIndicator();

  // Optional demo actions (guarded)
  const addBtn = qs('#addFundsBtn');
  if(addBtn){
    addBtn.addEventListener('click', () => {
      const el = qs('#demoBalance');
      const raw = el.textContent.replace(/,/g,'');
      const v = Number(raw);
      const next = v + 250;
      // Format using en-US to avoid locale-specific separators like middots
      el.textContent = next.toLocaleString('en-US', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      });
      toast('Demo balance updated');
    });
  }

  // Invite friends / referral
  const inviteBtn = qs('#inviteFriendsBtn');
  if(inviteBtn){
    // Navigate to dedicated invite page instead of copying directly.
    inviteBtn.addEventListener('click', () => {
      window.location.href = './invite.html';
    });
  }

  // User ID chip
  const userIdEl = qs('#userIdValue');
  const copyUserIdBtn = qs('#copyUserIdBtn');
  if(userIdEl){
    const raw = (
      window.LUX_USER_ID ||
      window.USER_ID ||
      localStorage.getItem('lux_user_id') ||
      localStorage.getItem('user_id') ||
      userIdEl.textContent
    );
    const uid = String(raw || '').trim() || '750899';
    userIdEl.textContent = uid;

    if(copyUserIdBtn){
      copyUserIdBtn.addEventListener('click', async () => {
        const ok = await safeCopy(uid);
        toast(ok ? 'ID copied ✅' : 'Copy failed');
      });
    }
  }

  // Top actions
  const settingsBtn = qs('#settingsBtn');
  const settingsMenu = qs('#settingsMenu');

  function positionSettingsMenu(){
    if(!settingsBtn || !settingsMenu) return;
    const r = settingsBtn.getBoundingClientRect();
    const top = Math.round(r.bottom + 10);
    const left = Math.max(10, Math.round(r.right - settingsMenu.offsetWidth));
    settingsMenu.style.top = `${top}px`;
    settingsMenu.style.left = `${left}px`;
    settingsMenu.style.right = 'auto';
  }

  function openSettingsMenu(){
    if(!settingsMenu) return;
    positionSettingsMenu();
    settingsMenu.classList.add('show');
    settingsMenu.setAttribute('aria-hidden','false');
  }

  function closeSettingsMenu(){
    if(!settingsMenu) return;
    settingsMenu.classList.remove('show');
    settingsMenu.setAttribute('aria-hidden','true');
  }

  function toggleSettingsMenu(){
    if(!settingsMenu) return;
    const isOpen = settingsMenu.classList.contains('show');
    isOpen ? closeSettingsMenu() : openSettingsMenu();
  }

  if(settingsBtn){
    settingsBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleSettingsMenu();
    });
  }

  if(settingsMenu){
    settingsMenu.addEventListener('click', (e) => {
      e.stopPropagation();
      const item = e.target.closest('.lux-menu-item');
      if(!item) return;
const actionRaw = String(item.getAttribute('data-action') || '').trim();
if(!actionRaw) return;

const action = ({
  levels: 'member',
  bonus: 'rewards',
  email: 'security',
  how: 'guide',
  download: 'getapp'
}[actionRaw] || actionRaw);

const txEl = qs('.lux-menu-tx', item);
const label = String(txEl ? txEl.textContent : (action || 'Done')).trim();

const evMap = {
  member: ['lux:settings:member', 'lux:settings:levels'],
  rewards: ['lux:settings:rewards', 'lux:settings:bonus'],
  security: ['lux:settings:security', 'lux:settings:email'],
  language: ['lux:settings:language'],
  about: ['lux:settings:about'],
  guide: ['lux:settings:guide', 'lux:settings:how'],
  getapp: ['lux:settings:getapp', 'lux:settings:download']
};

const events = evMap[action] || [`lux:settings:${action}`];
events.forEach(ev => window.dispatchEvent(new CustomEvent(ev)));
toast(label);

      // Simple page navigation for menu items that have pages.
      if(action === 'about'){
        window.location.href = './about.html';
      }
      if(action === 'guide'){
        window.location.href = './guide.html';
      }
      if(action === 'language'){
        window.location.href = './language.html';
      }
      // Added navigation to new pages
      if(action === 'member'){
        window.location.href = './member.html';
      }
      if(action === 'rewards'){
        window.location.href = './rewards.html';
      }
      if(action === 'luckydraw'){
        window.location.href = './Luckydraw.html';
      }
      if(action === 'security'){
        window.location.href = './security.html';
      }
      closeSettingsMenu();
    });
  }

  document.addEventListener('click', () => closeSettingsMenu());
  window.addEventListener('resize', () => {
    if(settingsMenu && settingsMenu.classList.contains('show')) positionSettingsMenu();
  });
  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape') closeSettingsMenu();
  });

  const refreshBtn = qs('#refreshBtn');
  if(refreshBtn){
    refreshBtn.addEventListener('click', () => {
      closeSettingsMenu();
      window.location.reload();
    });
  }

// Quick actions
const quickNetworkBtn = qs('#quickNetworkBtn');
if(quickNetworkBtn){
  quickNetworkBtn.addEventListener('click', () => {
    // Navigate to the new network page instead of emitting only events.
    window.location.href = './network.html';
  });
}

// Transfer quick action: detect button by its label and navigate
const quickButtons = qsa('.lux-quick');
quickButtons.forEach(btn => {
  const labelEl = qs('.lux-quick-label', btn);
  const label = String(labelEl ? labelEl.textContent : '').trim().toLowerCase();
  if(label === 'transfer'){
    btn.addEventListener('click', () => {
      window.location.href = './transfer.html';
    });
  }
});


  // Navigate to Wallet page
  const walletBtn = qs('#walletBtn');
  if(walletBtn){
    walletBtn.addEventListener('click', () => {
      window.location.href = './wallet.html';
    });
  }
// Navigate to Analytics page
  const analyticsBtn = qs('#analyticsBtn');
  if(analyticsBtn){
    analyticsBtn.addEventListener('click', () => {
      window.location.href = './analytics.html';
    });
  }

// Show a toast for other quick buttons too (Wallet / Transfer / Analytics)
qsa('.lux-quick').forEach(btn => {
  if(btn.id) return; // handled above
  btn.addEventListener('click', () => {
    const labelEl = qs('.lux-quick-label', btn);
    const label = String(labelEl ? labelEl.textContent : (btn.getAttribute('aria-label') || 'Done')).trim();
    toast(label);
  });
});

  // Live network rates (BNB/TRX/ETH)
  const rateEls = {
    bnb: qs('#rateBNB'),
    trx: qs('#rateTRX'),
    eth: qs('#rateETH'),
    chgBnb: qs('#chgBNB'),
    chgTrx: qs('#chgTRX'),
    chgEth: qs('#chgETH'),
    updated: qs('#ratesUpdatedAt')
  };

  const last = { bnb: null, trx: null, eth: null };

  function fmtUsd(v){
    if(!Number.isFinite(v)) return '--';
    if(v >= 1000) return `${v.toLocaleString('en-US', { maximumFractionDigits: 0 })} USDT`;
    if(v >= 1) return `${v.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} USDT`;
    return `${v.toLocaleString('en-US', { minimumFractionDigits: 4, maximumFractionDigits: 6 })} USDT`;
  }

  function fmtPct(v){
    if(!Number.isFinite(v)) return '--';
    const sign = v > 0 ? '+' : '';
    return `${sign}${v.toFixed(2)}%`;
  }

  function setTrend(el, trend){
    if(!el) return;
    el.classList.remove('is-up', 'is-down');
    if(trend === 'up') el.classList.add('is-up');
    if(trend === 'down') el.classList.add('is-down');
  }

  function setChange(el, v){
    if(!el){
      return;
    }
    el.textContent = fmtPct(v);
    el.classList.remove('good', 'bad');
    if(!Number.isFinite(v)) return;
    if(v >= 0) el.classList.add('good');
    else el.classList.add('bad');
  }

  const RATES_CACHE_KEY = 'lux_rates_cache_v1';

  function readCachedRates(){
    try{
      const raw = localStorage.getItem(RATES_CACHE_KEY);
      if(!raw) return null;
      const parsed = JSON.parse(raw);
      if(!parsed || typeof parsed !== 'object') return null;
      if(!parsed.data || !parsed.ts) return null;
      return parsed;
    }catch{
      return null;
    }
  }

  function writeCachedRates(data){
    try{
      localStorage.setItem(RATES_CACHE_KEY, JSON.stringify({ ts: Date.now(), data }));
    }catch{
      // ignore
    }
  }

  async function fetchJsonWithTimeout(url, timeoutMs){
    const ctrl = new AbortController();
    const t = setTimeout(() => ctrl.abort(), timeoutMs);
    try{
      const res = await fetch(url, {
        method: 'GET',
        headers: { 'accept': 'application/json' },
        cache: 'no-store',
        signal: ctrl.signal
      });
      if(!res.ok) throw new Error('rates_fetch_failed');
      return await res.json();
    }finally{
      clearTimeout(t);
    }
  }

  function normalizeFromBinance(arr){
    if(!Array.isArray(arr)) return null;
    const map = Object.create(null);
    for(const it of arr){
      const sym = String(it?.symbol || '');
      map[sym] = it;
    }
    const bnb = Number(map['BNBUSDT']?.lastPrice);
    const eth = Number(map['ETHUSDT']?.lastPrice);
    const trx = Number(map['TRXUSDT']?.lastPrice);
    const bnbChg = Number(map['BNBUSDT']?.priceChangePercent);
    const ethChg = Number(map['ETHUSDT']?.priceChangePercent);
    const trxChg = Number(map['TRXUSDT']?.priceChangePercent);
    if(!Number.isFinite(bnb) && !Number.isFinite(eth) && !Number.isFinite(trx)) return null;
    return {
      binancecoin: { usd: bnb, usd_24h_change: bnbChg },
      ethereum: { usd: eth, usd_24h_change: ethChg },
      tron: { usd: trx, usd_24h_change: trxChg }
    };
  }

  async function fetchRates(){
    // Fast path: Binance single-call 24h ticker (often faster than CoinGecko)
    try{
      const bUrl = 'https://api.binance.com/api/v3/ticker/24hr?symbols=%5B%22BNBUSDT%22,%22ETHUSDT%22,%22TRXUSDT%22%5D';
      const bData = await fetchJsonWithTimeout(bUrl, 2500);
      const normalized = normalizeFromBinance(bData);
      if(normalized) return normalized;
    }catch{
      // fallback below
    }

    const cgUrl = 'https://api.coingecko.com/api/v3/simple/price?ids=ethereum,binancecoin,tron&vs_currencies=usd&include_24hr_change=true';
    return await fetchJsonWithTimeout(cgUrl, 3500);
  }

  function applyRates(data){
    const eth = Number(data?.ethereum?.usd);
    const bnb = Number(data?.binancecoin?.usd);
    const trx = Number(data?.tron?.usd);

    const ethChg = Number(data?.ethereum?.usd_24h_change);
    const bnbChg = Number(data?.binancecoin?.usd_24h_change);
    const trxChg = Number(data?.tron?.usd_24h_change);

    if(rateEls.eth){
      rateEls.eth.textContent = fmtUsd(eth);
      const t = last.eth == null ? null : (eth > last.eth ? 'up' : (eth < last.eth ? 'down' : null));
      setTrend(rateEls.eth, t);
      last.eth = Number.isFinite(eth) ? eth : last.eth;
    }
    if(rateEls.bnb){
      rateEls.bnb.textContent = fmtUsd(bnb);
      const t = last.bnb == null ? null : (bnb > last.bnb ? 'up' : (bnb < last.bnb ? 'down' : null));
      setTrend(rateEls.bnb, t);
      last.bnb = Number.isFinite(bnb) ? bnb : last.bnb;
    }
    if(rateEls.trx){
      rateEls.trx.textContent = fmtUsd(trx);
      const t = last.trx == null ? null : (trx > last.trx ? 'up' : (trx < last.trx ? 'down' : null));
      setTrend(rateEls.trx, t);
      last.trx = Number.isFinite(trx) ? trx : last.trx;
    }

    setChange(rateEls.chgEth, ethChg);
    setChange(rateEls.chgBnb, bnbChg);
    setChange(rateEls.chgTrx, trxChg);

    // Updated timestamp intentionally hidden in UI
  }

  async function startRates(){
    if(!rateEls.bnb && !rateEls.trx && !rateEls.eth) return;

    // Show cached values instantly (prevents long wait on first paint)
    const cached = readCachedRates();
    if(cached?.data){
      // Accept cache up to 10 minutes old
      const age = Date.now() - Number(cached.ts || 0);
      if(Number.isFinite(age) && age >= 0 && age <= 10 * 60 * 1000){
        applyRates(cached.data);
      }
    }

    try{
      const data = await fetchRates();
      applyRates(data);
      writeCachedRates(data);
    }catch{
      // silent (UI keeps last cached values or placeholders)
    }

    let timer = null;
    const tick = async () => {
      try{
        const data = await fetchRates();
        applyRates(data);
        writeCachedRates(data);
      }catch{
        // silent
      }
    };

    const startTimer = () => {
      if(timer) return;
      timer = setInterval(tick, 20000);
    };

    const stopTimer = () => {
      if(!timer) return;
      clearInterval(timer);
      timer = null;
    };

    // Reduce background work on mobile
    document.addEventListener('visibilitychange', () => {
      if(document.hidden) stopTimer();
      else{
        tick();
        startTimer();
      }
    });

    startTimer();
  }

  function setImg(el, src, alt){
    if(!el) return;
    const img = document.createElement('img');
    img.className = 'lux-coin-icon';
    img.alt = alt || '';
    img.decoding = 'async';
    img.loading = 'lazy';
    img.referrerPolicy = 'no-referrer';
    img.src = src;
    el.replaceChildren(img);
  }

  function hydrateCoinIcons(){
    const ICONS = {
      bnb: 'https://cdn.jsdelivr.net/npm/cryptocurrency-icons@0.18.1/svg/color/bnb.svg',
      trx: 'https://cdn.jsdelivr.net/npm/cryptocurrency-icons@0.18.1/svg/color/trx.svg',
      eth: 'https://cdn.jsdelivr.net/npm/cryptocurrency-icons@0.18.1/svg/color/eth.svg'
    };

    const mapNetToCoin = { bep20: 'bnb', trc20: 'trx', erc20: 'eth' };
    qsa('.lux-netrate').forEach(row => {
      const net = String(row.getAttribute('data-net') || '').toLowerCase();
      const coin = mapNetToCoin[net];
      const holder = qs('.lux-netrate-ic', row);
      if(!holder || !coin || !ICONS[coin]) return;
      setImg(holder, ICONS[coin], coin.toUpperCase());
    });
  }

  hydrateCoinIcons();
  startRates();

// Subtle entrance motion
  window.addEventListener('load', () => {
    document.body.classList.add('lux-loaded');
  });
})();

</script>

</body>
</html>
